import json
import geohash
from sklearn.feature_extraction.text import onlineTfidfVectorizer
a = [[u'lt', u'tests', u'racheal', u'r_harvender3', u'embarrassment'], [u'hodges', u'oxlujgj9', u'hudson', u'house', u'ny'], [u'network', u'fest', u'jgl', u'fangirling', u'chirp'], [u'friend', u'best', u'wishing', u'frawley_kalyn', u'monday'], [u'leads', u'studying', u'shouldaknown', u'sleep', u'friend'], [u'haha', u'camp', u'letss', u'kayteeooh', u'rgyergyek'], [u'open', u'bring', u'eyes', u'sleep', u'day'], [u'_________', u'donuts', u'nothappy', u'krispy', u'kreme'], [u'carlos', u'givemeacnebeforeage25', u'scrubbed', u'dloooney', u'pimples'], [u'meaghss', u'just', u'cancel', u'mindblown', u'garage'], [u'lol', u'woods', u'bestshowever', u'easier', u'tiagenius'], [u'leroy', u'travel', u'ontario', u'u0ayqcld', u'plaza'], [u'ran', u'downs', u'c6eloesu', u'kohls', u'manager'], [u'smalltownpuck', u'pathetic', u'good', u'mean', u'sounds'], [u'rfdtv', u'toni_tedesco', u'15', u'dairy', u'barnes'], [u'ugh', u'iampatlee', u'pinecone', u'bday', u'daynuhsmith'], [u'lenikki', u'5ufq1gcq', u'chang', u'yummmm', u'getmeout'], [u'whatsnew', u'whilst', u'spend', u'willow_day', u'finals'], [u'rochester', u'atm', u'wmhlpbxt', u'esl', u'ny'], [u'venus', u'transit', u'vrfq3boy', u'5th', u'physics'], [u'games', u'xkristenn07', u'hoops', u'yayyyy', u'youngin'], [u'lecture', u'zuxtuubv', u'javits', u'skip', u'malalalalalala'], [u'rite', u'vamplife', u'ain', u'bout', u'sleep'], [u'break', u'joke', u'chance', u'fucking', u'try'], [u'hillview', u'cheers', u'hf1toa9l', u'vineyards', u'http'], [u'indulge', u'frosting', u'cupcake', u'woohooo', u'8qkvvi5t'], [u'downsite', u'ibm', u'frenchmandztana', u'jugurlselena90', u'asykk5ag'], [u'mom', u'athlete', u'loving', u'thank', u'downsite'], [u'betch', u'mikeluongo9', u'easy', u'towson', u'alllll'], [u'really', u'fuckyourself', u'liars', u'http', u'hate'], [u'tourney', u'henribendel', u'jladydyson', u'goal', u'jitney'], [u'head', u'nuryanggisari', u'phone', u'baggage', u'alexia'], [u'bullet', u'citizencope', u'target', u've', u'head'], [u'passed', u'adventureland', u'childhoodmemories', u'just', u'otpkapvc'], [u'lies', u'passed', u'adventureland', u'childhoodmemories', u'just'], [u'want', u'place', u'right', u'cyt6jeh6', u'inside'], [u'charles', u'black', u'ray', u'buddy', u'afsqf8kl'], [u'vqvfj8nt', u'arc', u'married', u'north', u'ave'], [u'http', u'brooklyn', u'ny', u'beach', u'respect'], [u'brooklyn', u'http', u'ny', u'rt', u'just'], [u'robbyrobinson12', u'text', u'brooklyn', u'http', u'ny'], [u'jones', u'beach', u'nikon', u'breezy', u'field'], [u'paper', u'jones', u'beach', u'nikon', u'breezy'], [u'madtired', u'cornayyy', u'paper', u'jones', u'beach'], [u'lt', u'hsm', u'wrote', u'shannonirish2', u'believe'], [u'robin', u'realising', u'thicke', u'jkblockette', u'jordanknight'], [u'heading', u'8ww6ekc8', u'mall', u'middle', u'home'], [u'hiimdabadguy', u'ok', u'right', u'tryin', u'wont'], [u'pillow', u'slam', u'90', u'tho', u'music'], [u'h4qmyp7l', u'check', u'newyork', u'laurens', u'weather'], [u'karid1213', u'sick', u'grandpa', u'beach', u'said'], [u'bum', u'lebrons', u'idk', u'say', u'mone2525'], [u'outta', u'mood', u'need', u'bum', u'lebrons'], [u'starts', u'falling', u'hands', u'instruc', u'washing'], [u'2qhzsfx5', u'promise', u'rookieblue', u'weeks', u'wait'], [u'christ', u'maxi', u'human', u'dpthekk_1', u'awkward'], [u'lexi_truax', u'fantasic', u'gymclass', u'christ', u'maxi'], [u'mattnuttle76', u'wegmans', u'nikanderson2563', u'krob_07', u'face'], [u'kourtykourtxo', u'hi', u'mattnuttle76', u'wegmans', u'nikanderson2563'], [u'0545', u'mod', u'sleepingin', u'nursing', u'means'], [u'mdu5cysa', u'gonnna', u'daniellejdougs', u'misss', u'lauren_bayybee'], [u'game', u'edward', u'goodboyfriendtweet', u'blue', u'cuddle'], [u'therealslips', u'sportscenter', u'soooo', u'luck', u'catch'], [u'welch', u'corporate', u'skaneateles', u'sspv6hf5', u'allyn'], [u'yep', u'duhh', u'dirkybabyyy', u'factor', u'left'], [u'steph_peltak', u'yep', u'duhh', u'dirkybabyyy', u'factor'], [u'join', u'thisis_nikki', u'couple', u'billywickett', u'kidding'], [u'bronx', u'http', u'ny', u'don', u'want'], [u'fuuuuuuuuckkkkkiiing', u'kiiimkaay', u'soooooo', u'soo', u'prometheus'], [u'pfchangs', u'jeordiewhite', u'fuuuuuuuuckkkkkiiing', u'kiiimkaay', u'soooooo'], [u'traviesclark', u'visit', u'whatreally', u'kaylon', u'johnmong845'], [u'motto', u'lonely', u'talented', u'dog', u'traviesclark'], [u'bblahqo6', u'galway', u'east', u'http', u'motto'], [u'0_o', u'newyorkcares', u'pelham', u'jais', u'gun'], [u'loud', u'ii', u'texts', u'polish', u'callme_owee']]
hash = ['dre9', 'dre8', 'drft', 'dr8g', 'drfw', 'dr8j', 'dr8k', 'drfz', 'dre2', 'dr8n', 'dre7', 'dr8s', 'drdm', 'dr8v', 'drdk', 'dr8t', 'dr8u', 'dr95', 'dr8y', 'dr7b', 'dr9h', 'drk0', 'drhp', 'dre3', 'dpxf', 'dr7r', 'dr7k', 'dr7j', 'dr7h', 'dr7m', 'drk8', 'dr5x', 'dr7q', 'dr5z', 'dr7w', 'dpxu', 'dpxv', 'dr7t', 'dr5q', 'dr5r', 'dr9g', 'dr5w', 'dre0', 'dr9m', 'dr8h', 'drg8', 'drgw', 'drf5', 'dr9k', 'drd9', 'dr9e', 'dres', 'drcc', 'drew', 'dreh', 'drek', 'dr8e', 'dr85', 'dr9u', 'dr9t', 'dr9v', 'dree', 'dred', 'dr9s', 'dr6g', 'drfh', 'dpxg', 'dr72', 'dr77', 'dr5n', 'dr75', 'dr76', 'drem', 'dr78', 'dr8w']
histo = {}
f = 'newyork.txt'
with open(f) as infile:
    for line in infile:
        line = json.loads(line)
        x = float(line['geo']['coordinates'][0])
        y = float(line['geo']['coordinates'][1])
        vectorizer = onlineTfidfVectorizer(min_df = 1, smooth_idf=True, stop_words='english')
        X = vectorizer.fit_transform(line['text'])
        voc = vectorizer.vocabulary_
        for r in a[hash.index(geohash.encode(x,y,4))]:
            if r in voc:
                t = line['created_at']
                t = int(t.strip().split()[2]) 
                